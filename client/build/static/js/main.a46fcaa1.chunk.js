(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{189:function(e,t,n){},190:function(e,t,n){},285:function(e,t,n){"use strict";n.r(t);var s=n(0),a=n.n(s),c=n(29),r=n.n(c),i=(n(189),n(27)),o=n.n(i),u=n(36),l=n(21),j=(n(190),n(74)),b=n.n(j);function d(e,t){var n,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if("string"===typeof t&&(t=t.split(".")),!e)return s;for(n=0;n<t.length&&(e=e[t[n]]);n++);return n===t.length?void 0===e?s:e:s}var h=function(e){return e.then((function(e){return[null,e]})).catch((function(e){return[e,null]}))},O="/api/",f=function(e){return function(t){return e?t.data:t}},m=function(e){return function(t){throw 401===d(t,["response","data","code"])&&d(t,"/api/user/validate"!==["response","config","url"])&&(window.location.href="/",localStorage.setItem("rms_token","")),e?t.response.data:t}},p=function(e){return{headers:e}},g=function(e,t){return{get:function(n){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return h(b.a.get("".concat(t).concat(n),p(s)).then(f(e)).catch(m(e)))},post:function(n,s){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return h(b.a.post("".concat(t).concat(n),s,p(a)).then(f(e)).catch(m(e)))},put:function(n,s){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return h(b.a.put("".concat(t).concat(n),s,p(a)).then(f(e)).catch(m(e)))},patch:function(n,s){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return h(b.a.patch("".concat(t).concat(n),s,p(a)).then(f(e)).catch(m(e)))},del:function(n){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return h(b.a.delete("".concat(t).concat(n),p(s)).then(f(e)).catch(m(e)))},head:function(e,n){return h(b.a.head("".concat(t).concat(e),p(n)).then(f(!1)).catch(m(!1)))}}},x=g(!0,O),v=(g(!1,O),g(!0,""),n(68)),k=n(28),y=n(25),w=n(178),S=n(292),C=n(294),I=n(288),A=n(289),P=n(37),U=n(6),H=function(e){var t=e.children;return Object(U.jsxs)(I.a,{children:[Object(U.jsxs)(A.a,{span:6,offset:9,style:{paddingTop:150},children:[Object(U.jsx)("h1",{style:{textAlign:"center"},children:"Welcome"}),t]}),Object(U.jsx)(A.a,{span:12,offset:6,children:Object(U.jsx)("img",{src:"/background.jpg",style:{width:"100%"}})})]})},T={labelCol:{span:8},wrapperCol:{span:24}},_={wrapperCol:{span:24}},E=function(){var e=Object(u.a)(o.a.mark((function e(t,n,s){var a,c,r,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.post("users/login/",t);case 2:if(a=e.sent,c=Object(l.a)(a,2),r=c[0],i=c[1],!r){e.next=8;break}return e.abrupt("return",w.b.error(r.msg||r.error.msg||"Something went wrong"));case 8:w.b.success("User ".concat(i.user.username," has logged in successfully")),localStorage.setItem("auth-token",i.token),s(i.user),i.user.isAdmin?n.push("/admin"):n.push("/user-dashboard");case 12:case"end":return e.stop()}}),e)})));return function(t,n,s){return e.apply(this,arguments)}}(),N=function(e){var t=e.setUser,n=Object(k.g)();return Object(U.jsx)(H,{children:Object(U.jsxs)(S.a,Object(y.a)(Object(y.a)({},T),{},{name:"basic",initialValues:{remember:!0},onFinish:function(e){return E(e,n,t)},layout:"vertical",children:[Object(U.jsx)(S.a.Item,{label:"Username",name:"username",rules:[{required:!0,message:"Please input your username!"}],children:Object(U.jsx)(C.a,{})}),Object(U.jsx)(S.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}],children:Object(U.jsx)(C.a.Password,{})}),Object(U.jsx)(S.a.Item,Object(y.a)(Object(y.a)({},_),{},{children:Object(U.jsxs)(I.a,{children:[Object(U.jsx)(A.a,{span:12,children:Object(U.jsx)(P.a,{type:"primary",htmlType:"submit",block:!0,children:"Login"})}),Object(U.jsx)(A.a,{span:12,children:Object(U.jsx)(v.b,{to:"/signup",children:Object(U.jsx)(P.a,{block:!0,children:"Register"})})})]})}))]}))})},F={labelCol:{span:8},wrapperCol:{span:24}},M={wrapperCol:{span:24}},D=function(){var e=Object(u.a)(o.a.mark((function e(t){var n,s,a,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.post("users/",t);case 2:if(n=e.sent,s=Object(l.a)(n,2),a=s[0],c=s[1],!a){e.next=8;break}return e.abrupt("return",w.b.error(a.msg||a.error.msg||"Something went wrong"));case 8:w.b.success("User ".concat(c.newUser.username," has created successfully. please log in"));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(){return Object(U.jsx)(H,{children:Object(U.jsxs)(S.a,Object(y.a)(Object(y.a)({},F),{},{name:"basic",initialValues:{remember:!0},onFinish:D,layout:"vertical",children:[Object(U.jsx)(S.a.Item,{label:"Username",name:"username",rules:[{required:!0,message:"Please input your username!"}],children:Object(U.jsx)(C.a,{})}),Object(U.jsx)(S.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}],children:Object(U.jsx)(C.a.Password,{})}),Object(U.jsx)(S.a.Item,Object(y.a)(Object(y.a)({},M),{},{children:Object(U.jsxs)(I.a,{children:[Object(U.jsx)(A.a,{span:12,children:Object(U.jsx)(P.a,{type:"primary",htmlType:"submit",block:!0,children:"Register"})}),Object(U.jsx)(A.a,{span:12,children:Object(U.jsx)(v.b,{to:"/login",children:Object(U.jsx)(P.a,{block:!0,children:"Login"})})})]})}))]}))})},W=n(125),R=n(170),z=n(296),G=n(168),q=n(169),J=function(){function e(){Object(G.a)(this,e),this.socket=null,this.hooks={}}return Object(q.a)(e,[{key:"connect",value:function(e,t){var n=this;if(this.socket)return!1;this.socket=new WebSocket("ws://"+window.location.host),this.socket.addEventListener("open",(function(s){console.log("Connected to WS Server");var a=e.isAdmin,c=e.username,r=e._id;n.emitMessage("set_user",{isAdmin:a,username:c,_id:r}),t()})),this.socket.addEventListener("message",(function(e){try{var t=JSON.parse(e.data);n.hooks[t.type]&&n.hooks[t.type](t.payload)}catch(s){console.log("invalid data",s,e.data)}})),this.socket.addEventListener("close",(function(s){console.log("Socket is closed. Reconnect will be attempted in 1 second.",s.reason),n.socket=null,setTimeout((function(){n.connect(e,t)}),1e3)}))}},{key:"emitMessage",value:function(e,t){var n=this;this.socket&&this.socket.readyState===WebSocket.OPEN?this.socket.send(JSON.stringify({type:e,payload:t})):setTimeout((function(){n.emitMessage(e,t)}),500)}},{key:"sendMessage",value:function(e,t,n){this.emitMessage("user_message",{sessionId:t,username:e.username,isAdmin:e.isAdmin,message:n})}},{key:"updatePoints",value:function(e,t){this.emitMessage("update_points",{sessionId:e,points:t})}},{key:"addHook",value:function(e,t){this.hooks[e]=t}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),Y=n(295),B=function(e){var t=e.setSession,n=Object(s.useState)(!0),a=Object(l.a)(n,2),c=a[0],r=a[1],i=localStorage.getItem("auth-token"),j=Object(s.useState)(""),b=Object(l.a)(j,2),d=b[0],h=b[1];return Object(U.jsx)(U.Fragment,{children:Object(U.jsx)(Y.a,{title:"Enter a Session Code",visible:c,maskClosable:!1,onOk:Object(u.a)(o.a.mark((function e(){var n,s,a,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.get("session/"+d,{token:i});case 2:n=e.sent,s=Object(l.a)(n,2),a=s[0],c=s[1],a?w.b.error("Something went wrong"):c.session?(t(c.session),r(!1)):w.b.info("No found the Session. Please check and retry");case 7:case"end":return e.stop()}}),e)}))),onCancel:function(){return r(!0)},children:Object(U.jsx)(C.a,{value:d,onChange:function(e){return h(e.target.value)}})})})},K=n(85),V=n.n(K),Q=null,X=function(e){var t=e.user,n=Object(s.useState)(0),a=Object(l.a)(n,2),c=a[0],r=a[1],i=Object(s.useState)(""),o=Object(l.a)(i,2),u=o[0],j=o[1],b=Object(s.useState)(null),h=Object(l.a)(b,2),O=h[0],f=h[1];return Object(s.useEffect)((function(){t&&((Q=J.getInstance()).connect(t,(function(){console.log("websocket connected")})),Q.addHook("user_message",(function(e){f(Object(y.a)(Object(y.a)({},O),{},{messages:[].concat(Object(W.a)(O.messages),[e])}))})),Q.addHook("changed_points",(function(e){f(Object(y.a)(Object(y.a)({},O),{},{points:e})),r(e[t._id])})))}),[t,O]),Object(s.useEffect)((function(){O&&r(d(O,["points",t._id]))}),[O]),t?O?Object(U.jsxs)(U.Fragment,{children:[Object(U.jsxs)(I.a,{style:{marginTop:100},children:[Object(U.jsx)(A.a,{span:6,offset:9,children:Object(U.jsxs)("p",{style:{textAlign:"center"},children:["Session ID: ",O.id]})}),Object(U.jsx)(A.a,{span:6,offset:9,children:Object(U.jsx)(C.a,{value:t.username,style:{textAlign:"center"}})})]}),Object(U.jsx)(I.a,{style:{marginTop:20},children:Object(U.jsx)(A.a,{span:6,offset:9,children:Object(U.jsx)(C.a,{value:c,style:{textAlign:"center"}})})}),Object(U.jsx)(I.a,{style:{marginTop:20},children:Object(U.jsx)(A.a,{span:12,offset:6,children:Object(U.jsx)("div",{style:{minHeight:200,maxHeight:"70vh",overflow:"auto"},children:O.messages.filter((function(e){var n=e.username;return e.isAdmin||n===t.username})).map((function(e){var t=e.username,n=e.isAdmin,s=e.message,a=e.time;return Object(U.jsxs)("div",{children:[Object(U.jsx)(z.a,{color:"default",children:n?"Admin":t}),": (",V()(a).format("HH:mm:ss"),")"," ",s]},a)}))})})}),Object(U.jsxs)(I.a,{style:{marginTop:20},children:[Object(U.jsx)(A.a,{span:10,offset:6,children:Object(U.jsx)(C.a,{value:u,onChange:function(e){return j(e.target.value)}})}),Object(U.jsx)(A.a,{span:2,children:Object(U.jsx)(P.a,{style:{marginLeft:5},type:"primary",block:!0,disabled:""===u,onClick:function(){Q.sendMessage(t,O.id,u),j("")},children:"SEND"})})]})]}):Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)("div",{children:"Select a Session"}),Object(U.jsx)(B,{setSession:f})]}):Object(U.jsx)(R.a,{})},Z=n(290),$=n(73),ee=n(182),te=n(110),ne=n(293),se=n(297),ae=n(298),ce=function(e){var t=e.username,n=e.totalPoint,a=e.userId,c=e.setTotalPoint,r=Object(s.useState)(0),i=Object(l.a)(r,2),o=i[0],u=i[1];return Object(U.jsxs)(I.a,{children:[Object(U.jsx)(A.a,{span:8,style:{display:"flex",alignItems:"center",textAlign:"right"},children:t}),Object(U.jsxs)(A.a,{span:16,style:{display:"flex",alignItems:"center"},children:[Object(U.jsx)(ne.a,{style:{maxWidth:50,marginRight:5},min:0,value:o,onChange:function(e){return u(e)}}),Object(U.jsx)(P.a,{icon:Object(U.jsx)(se.a,{}),onClick:function(){return c((n||0)+o,a)},size:"small"}),Object(U.jsx)(P.a,{icon:Object(U.jsx)(ae.a,{}),onClick:function(){return c((n||0)-o,a)},size:"small"}),Object(U.jsx)(z.a,{style:{marginLeft:5,marginRight:0},color:"volcano",children:n||0})]})]})},re=function(e){var t=e.onlineUsers,n=e.session,a=e.setSession,c=e.allUsers,r=e.onScoreUpdate,i=Object(s.useState)(0),o=Object(l.a)(i,2),u=o[0],j=o[1],b=t.reduce((function(e,t){return e[t.username]=t,e}),{});return Object(U.jsxs)("div",{children:[Object(U.jsxs)(A.a,{style:{display:"flex",alignItems:"center"},span:16,offset:8,children:[Object(U.jsx)(ne.a,{style:{maxWidth:50,marginRight:5},value:u,onChange:function(e){return j(e)},min:0}),Object(U.jsx)(P.a,{size:"small",onClick:function(){var e=c.reduce((function(e,t){return e[t._id]=u,e}),{});a(Object(y.a)(Object(y.a)({},n),{},{points:e}))},children:"SET"})]}),c.filter((function(e){return!e.isAdmin&&!!b[e.username]})).map((function(e){return Object(U.jsx)(ce,{userId:e._id,username:e.username,totalPoint:d(n,["points",e._id]),setTotalPoint:function(e,t){a(Object(y.a)(Object(y.a)({},n),{},{points:Object(y.a)(Object(y.a)({},n.points),{},Object(te.a)({},t,e))}))}})})),Object(U.jsx)("div",{style:{marginTop:10},children:Object(U.jsx)(P.a,{type:"primary",onClick:r,children:"Update"})})]})},ie=n(291),oe=function(e){var t=e.setSession,n=Object(s.useState)(!0),a=Object(l.a)(n,2),c=a[0],r=a[1],i=localStorage.getItem("auth-token"),j=Object(s.useState)([]),b=Object(l.a)(j,2),d=b[0],h=b[1];return Object(s.useEffect)((function(){Object(u.a)(o.a.mark((function e(){var t,n,s,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.get("session",{token:i});case 2:if(t=e.sent,n=Object(l.a)(t,2),s=n[0],a=n[1],!s){e.next=8;break}return e.abrupt("return",w.b.error(s.msg||s.error.msg||"Something Went Wrong"));case 8:h(a.sessions);case 9:case"end":return e.stop()}}),e)})))()}),[]),Object(U.jsx)(U.Fragment,{children:Object(U.jsx)(Y.a,{title:"Create A New Game",visible:c,onOk:function(){return r(!0)},onCancel:function(){return r(!0)},maskClosable:!1,children:Object(U.jsx)(ie.a,{dataSource:d,columns:[{title:"Started At",dataIndex:"createdAt",render:function(e){return V()(e).format("YYYY-MM-DD  HH:mm")}},{title:"ID",dataIndex:"id"}],pagination:{position:["none","none"]},rowKey:"_id",onRow:function(e){return{onClick:function(){var n=Object(u.a)(o.a.mark((function n(){var s,a,c,u;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,x.get("session/"+e._id,{token:i});case 2:if(s=n.sent,a=Object(l.a)(s,2),c=a[0],u=a[1],!c){n.next=8;break}return n.abrupt("return",w.b.error("Something went wrong"));case 8:t(u.session),r(!1);case 10:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}()}}})})})},ue=Z.a.Header,le=Z.a.Content,je=Z.a.Footer,be=null,de=function(e){var t=e.session,n=e.setSession,a=Object(s.useState)(!1),c=Object(l.a)(a,2),r=c[0],i=c[1],j=Object(s.useState)(Object(ee.a)(6)),b=Object(l.a)(j,2),d=b[0],h=b[1],O=localStorage.getItem("auth-token"),f=function(){var e=Object(u.a)(o.a.mark((function e(){var t,s,a,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.post("session",{id:d},{token:O});case 2:if(t=e.sent,s=Object(l.a)(t,2),a=s[0],c=s[1],!a){e.next=8;break}return e.abrupt("return",w.b.error(a.msg||a.error.msg||"Something Went Wrong"));case 8:w.b.success("Game Create with Game ID: ".concat(d)),w.b.info("Please share this game ID with others to join"),n(c.newSession),i(!1);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(U.jsxs)($.a,{theme:"dark",mode:"horizontal",selectedKeys:[],selectable:!1,children:[Object(U.jsx)($.a.Item,{onClick:function(){return i(!0)},children:"Create A New Game"},1),Object(U.jsxs)($.a.Item,{style:{float:"right"},children:["key: ",t&&t.id||"N/A"]},2),Object(U.jsx)(Y.a,{title:"Create A New Game",visible:r,onOk:f,onCancel:function(){return i(!1)},children:Object(U.jsx)(C.a,{value:d,onChange:function(e){return h(e.target.value)}})})]})},he=function(e){var t=e.user,n=localStorage.getItem("auth-token"),a=Object(k.g)(),c=Object(s.useState)(null),r=Object(l.a)(c,2),i=r[0],j=r[1],b=Object(s.useState)([]),d=Object(l.a)(b,2),h=d[0],O=d[1],f=Object(s.useState)([]),m=Object(l.a)(f,2),p=m[0],g=m[1];t&&!t.isAdmin&&(a.push("/login"),w.b.error("Access Denied")),Object(s.useEffect)((function(){t&&((be=J.getInstance()).connect(t,(function(){console.log("websocket connected")})),be.addHook("user_message",(function(e){j(Object(y.a)(Object(y.a)({},i),{},{messages:[].concat(Object(W.a)(i.messages),[e])}))})),be.addHook("user_changed",(function(e){O(e)})))}),[t,i]),Object(s.useEffect)((function(){Object(u.a)(o.a.mark((function e(){var t,s,a,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.get("users/all-users",{token:n});case 2:if(t=e.sent,s=Object(l.a)(t,2),a=s[0],c=s[1],!a){e.next=8;break}return e.abrupt("return",w.b.error("Something went wrong, please refresh the page"));case 8:g(c.users);case 9:case"end":return e.stop()}}),e)})))()}),[]);var v=Object(s.useState)(""),S=Object(l.a)(v,2),H=S[0],T=S[1];return Object(U.jsxs)(Z.a,{style:{height:"100vh"},children:[Object(U.jsxs)(ue,{style:{position:"fixed",zIndex:1,width:"100%"},children:[Object(U.jsx)("div",{className:"logo"}),Object(U.jsx)(de,{setSession:j,session:i})]}),Object(U.jsx)(le,{className:"site-layout",style:{padding:"0 50px",marginTop:64},children:Object(U.jsx)("div",{className:"site-layout-background",style:{padding:24,minHeight:380},children:i&&Object(U.jsx)(I.a,{children:Object(U.jsx)(A.a,{span:20,offset:2,children:Object(U.jsxs)(I.a,{children:[Object(U.jsxs)(A.a,{span:17,children:[Object(U.jsx)("div",{style:{minHeight:500,maxHeight:"70vh",overflow:"auto"},children:i.messages.map((function(e){var t=e.username,n=e.isAdmin,s=e.message,a=e.time;return Object(U.jsxs)("div",{children:[Object(U.jsx)(z.a,{color:"default",children:n?"Admin":t}),": (",V()(a).format("HH:mm:ss"),")"," ",s]},a)}))}),Object(U.jsxs)(I.a,{style:{marginTop:20},children:[Object(U.jsx)(A.a,{span:20,children:Object(U.jsx)(C.a,{value:H,onChange:function(e){return T(e.target.value)}})}),Object(U.jsx)(A.a,{span:4,children:Object(U.jsx)(P.a,{style:{marginLeft:5},type:"primary",block:!0,disabled:""===H,onClick:function(){be.sendMessage(t,i.id,H),T("")},children:"SEND"})})]})]}),Object(U.jsx)(A.a,{span:6,offset:1,children:Object(U.jsx)(re,{onlineUsers:h,session:i,setSession:j,allUsers:p,onScoreUpdate:function(){be.updatePoints(i.id,i.points)}})})]})})})})}),Object(U.jsx)(je,{style:{textAlign:"center"}}),!i&&Object(U.jsx)(oe,{setSession:j})]})},Oe=function(e){var t=e.user,n=e.setUser;return Object(U.jsx)(v.a,{children:Object(U.jsxs)(k.d,{children:[Object(U.jsx)(k.b,{path:"/home",children:Object(U.jsx)(N,{user:t,setUser:n})}),Object(U.jsx)(k.b,{path:"/signup",children:Object(U.jsx)(L,{user:t,setUser:n})}),Object(U.jsx)(k.b,{path:"/admin",children:Object(U.jsx)(he,{user:t,setUser:n})}),Object(U.jsx)(k.b,{path:"/user-dashboard",children:Object(U.jsx)(X,{user:t,setUser:n})}),Object(U.jsx)(k.b,{path:"/",children:Object(U.jsx)(k.a,{to:"/home"})})]})})};var fe=function(){var e=Object(s.useState)(!1),t=Object(l.a)(e,2),n=(t[0],t[1]),a=Object(s.useState)(null),c=Object(l.a)(a,2),r=c[0],i=c[1],j=localStorage.getItem("auth-token")||"";return Object(s.useEffect)((function(){Object(u.a)(o.a.mark((function e(){var t,s,a,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(!0),e.next=3,x.get("users/validate",{token:j});case 3:t=e.sent,s=Object(l.a)(t,2),a=s[0],c=s[1],i(a?null:c.user),n(!1);case 9:case"end":return e.stop()}}),e)})))()}),[]),Object(U.jsx)("div",{className:"App",children:Object(U.jsx)(Oe,{user:r,setUser:i})})},me=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,299)).then((function(t){var n=t.getCLS,s=t.getFID,a=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),s(e),a(e),c(e),r(e)}))};r.a.render(Object(U.jsx)(a.a.StrictMode,{children:Object(U.jsx)(fe,{})}),document.getElementById("root")),me()}},[[285,1,2]]]);